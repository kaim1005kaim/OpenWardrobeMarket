# æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®é¡ä¼¼åº¦æ¤œç´¢å®Ÿè£…ã‚¬ã‚¤ãƒ‰

## ğŸ“‹ æ¦‚è¦

ç”»åƒãŒãªã„æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã§ã‚‚ã€**ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ã®ç–‘ä¼¼ãƒ™ã‚¯ãƒˆãƒ«**ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã§é¡ä¼¼åº¦æ¤œç´¢ãŒå¯èƒ½ã§ã™ã€‚

## âœ… å®Ÿè£…å®Œäº†

### 1. ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ç–‘ä¼¼åŸ‹ã‚è¾¼ã¿ç”Ÿæˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `scripts/generate-tag-based-embeddings.ts`

**ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **:
```
1. å„ã‚¿ã‚°ã‚’SHA-256ã§ãƒãƒƒã‚·ãƒ¥åŒ–
2. ãƒãƒƒã‚·ãƒ¥å€¤ã‹ã‚‰512æ¬¡å…ƒã®ã†ã¡8æ¬¡å…ƒã‚’é¸æŠ
3. é¸æŠã—ãŸæ¬¡å…ƒã«é‡ã¿ä»˜ãã§å€¤ã‚’è¿½åŠ 
4. å˜ä½ãƒ™ã‚¯ãƒˆãƒ«ã«æ­£è¦åŒ–ï¼ˆã‚³ã‚µã‚¤ãƒ³é¡ä¼¼åº¦ç”¨ï¼‰
```

**å®Ÿè¡Œæ–¹æ³•**:
```bash
npx tsx scripts/generate-tag-based-embeddings.ts
```

**å®Ÿè¡Œçµæœ**:
```
ğŸ“¦ Found 25 items with tags
âœ… Success: 8
âŒ Failed: 17  # ã‚¿ã‚°ãŒãªã„ã‚¢ã‚¤ãƒ†ãƒ 
```

### 2. é¡ä¼¼åº¦æ¤œç´¢ãƒ†ã‚¹ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `scripts/test-similarity-search.ts`

**ä½¿ç”¨æ–¹æ³•**:
```bash
# åˆ©ç”¨å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒªã‚¹ãƒˆ
npx tsx scripts/test-similarity-search.ts

# ç‰¹å®šã‚¢ã‚¤ãƒ†ãƒ ã®é¡ä¼¼æ¤œç´¢
npx tsx scripts/test-similarity-search.ts <item-id>
```

**ãƒ†ã‚¹ãƒˆçµæœ**:
- âœ… Pure Vector Search: å‹•ä½œç¢ºèªæ¸ˆã¿
- âœ… Hybrid Search: å‹•ä½œç¢ºèªæ¸ˆã¿
- âœ… ã‚³ã‚µã‚¤ãƒ³é¡ä¼¼åº¦è¨ˆç®—: æ­£å¸¸

## ğŸ” 3ã¤ã®é¡ä¼¼åº¦æ¤œç´¢æ–¹æ³•

### æ–¹æ³•1: ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ç–‘ä¼¼ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰

**åˆ©ç‚¹**:
- âš¡ å³åº§ã«å®Ÿè£…å¯èƒ½
- ğŸ’° å®Œå…¨ç„¡æ–™ï¼ˆå¤–éƒ¨APIä¸è¦ï¼‰
- ğŸ¯ ã‚¿ã‚°ã®é¡ä¼¼æ€§ã‚’ä¿è¨¼

**æ¬ ç‚¹**:
- è¦–è¦šçš„ç‰¹å¾´ã¯æ‰ãˆã‚‰ã‚Œãªã„
- ã‚¿ã‚°ãŒãªã„ã‚¢ã‚¤ãƒ†ãƒ ã«ã¯ä½¿ãˆãªã„

**ç²¾åº¦**: 60-75%ï¼ˆã‚¿ã‚°ã®è³ªã«ä¾å­˜ï¼‰

### æ–¹æ³•2: Sentence Transformersï¼ˆæ¨å¥¨ãƒ»æ¬¡ã‚¹ãƒ†ãƒƒãƒ—ï¼‰

ã‚¿ã‚°ã‚’è‡ªç„¶è¨€èªã¨ã—ã¦åŸ‹ã‚è¾¼ã‚€ã€‚

**å®Ÿè£…ä¾‹**:
```bash
# Hugging Face Inference API
curl https://api-inference.huggingface.co/models/sentence-transformers/all-MiniLM-L6-v2 \
  -H "Authorization: Bearer $HUGGINGFACE_API_KEY" \
  -d '{"inputs": "oversized streetwear neutral tones"}'
```

**åˆ©ç‚¹**:
- ğŸ¯ ã‚¿ã‚°ã®æ„å‘³çš„é¡ä¼¼æ€§ã‚’ç†è§£
- ğŸ’° ç„¡æ–™ï¼ˆHugging Faceï¼‰
- ğŸš€ ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ã‚ˆã‚Šé«˜ç²¾åº¦

**ç²¾åº¦**: 75-85%

### æ–¹æ³•3: CLIPåŸ‹ã‚è¾¼ã¿ï¼ˆæœ€é«˜ç²¾åº¦ãƒ»ç”»åƒå¿…é ˆï¼‰

å®Ÿéš›ã®ç”»åƒã‹ã‚‰CLIPåŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆã€‚

**åˆ©ç‚¹**:
- ğŸ¨ è¦–è¦šçš„ç‰¹å¾´ã‚’å®Œå…¨ã«æ‰ãˆã‚‹
- ğŸ† æœ€é«˜ç²¾åº¦

**æ¬ ç‚¹**:
- ç”»åƒãŒå¿…è¦

**ç²¾åº¦**: 85-95%

## ğŸ“Š å®Ÿè£…ã®å„ªå…ˆé †ä½

### ä»Šã™ãï¼ˆå®Œäº†âœ…ï¼‰
```bash
# ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ç–‘ä¼¼ãƒ™ã‚¯ãƒˆãƒ«
npx tsx scripts/generate-tag-based-embeddings.ts
```

### 1é€±é–“ä»¥å†…ï¼ˆæ¨å¥¨ï¼‰
```typescript
// Sentence Transformersçµ±åˆ
// scripts/generate-text-embeddings.ts ã‚’ä½œæˆ
```

### é•·æœŸï¼ˆç”»åƒãŒæƒã£ãŸã‚‰ï¼‰
```typescript
// CLIPåŸ‹ã‚è¾¼ã¿
npx tsx scripts/generate-embeddings-batch.ts
```

## ğŸ¯ Sentence Transformerså®Ÿè£…æ¡ˆ

```typescript
// scripts/generate-text-embeddings.ts

async function generateTextEmbedding(tags: string[]): Promise<number[]> {
  const text = tags.join(' '); // "oversized streetwear neutral"

  const response = await fetch(
    'https://api-inference.huggingface.co/models/sentence-transformers/all-MiniLM-L6-v2',
    {
      method: 'POST',
      headers: {
        Authorization: `Bearer ${HF_API_KEY}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ inputs: text }),
    }
  );

  const embedding = await response.json();
  return embedding; // 384æ¬¡å…ƒ â†’ 512æ¬¡å…ƒã«ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°
}
```

## ğŸ“ˆ æ¤œç´¢ç²¾åº¦ã®æ¯”è¼ƒ

| æ–¹æ³• | ç²¾åº¦ | ã‚³ã‚¹ãƒˆ | å®Ÿè£…é›£æ˜“åº¦ | çŠ¶æ…‹ |
|------|------|--------|-----------|------|
| ã‚¿ã‚°ç–‘ä¼¼ãƒ™ã‚¯ãƒˆãƒ« | 60-75% | ç„¡æ–™ | ç°¡å˜ | âœ… å®Œäº† |
| Sentence Transformers | 75-85% | ç„¡æ–™ | ä¸­ | ğŸ“ æ¨å¥¨ |
| CLIP (ç”»åƒ) | 85-95% | æœ‰æ–™ | ä¸­ | â³ ç”»åƒå¾…ã¡ |

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®é¡ä¼¼æ¤œç´¢ã‚’æœ‰åŠ¹åŒ–

1. **ç–‘ä¼¼ãƒ™ã‚¯ãƒˆãƒ«ç”Ÿæˆ**
```bash
npx tsx scripts/generate-tag-based-embeddings.ts
```

2. **å‹•ä½œç¢ºèª**
```bash
npx tsx scripts/test-similarity-search.ts
```

3. **ã‚¢ãƒ—ãƒªã§ç¢ºèª**
   - è©³ç´°ãƒšãƒ¼ã‚¸ã‚’é–‹ã
   - ã€ŒSIMILAR DESIGNSã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«é¡ä¼¼ã‚¢ã‚¤ãƒ†ãƒ ãŒè¡¨ç¤ºã•ã‚Œã‚‹
   - ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã« `[MobileDetailModal] Search algorithm: vector_hybrid` ã¨è¡¨ç¤º

### æ–°è¦ç”»åƒã®è‡ªå‹•å‡¦ç†

æ–°ã—ãç”»åƒã‚’ç”Ÿæˆã™ã‚‹ã¨:
```
1. ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¿ã‚°ç”Ÿæˆ
2. Gemini Visionè§£æ
3. CLIPåŸ‹ã‚è¾¼ã¿ç”Ÿæˆ â† æœ¬ç‰©ã®è¦–è¦šçš„åŸ‹ã‚è¾¼ã¿
4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜
```

â†’ æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ï¼ˆç–‘ä¼¼ï¼‰ã¨æ–°è¦ãƒ‡ãƒ¼ã‚¿ï¼ˆCLIPï¼‰ãŒæ··åœ¨ã—ã¦ã‚‚å•é¡Œãªãå‹•ä½œ

## ğŸ’¡ ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ã®ä»•çµ„ã¿

```sql
-- ä¸¡æ–¹ã®é¡ä¼¼åº¦ã‚’çµ„ã¿åˆã‚ã›
combined_score =
  vector_similarity * 0.7 +  -- ã‚³ã‚µã‚¤ãƒ³é¡ä¼¼åº¦
  tag_similarity * 0.3        -- Jaccardé¡ä¼¼åº¦

-- ä¾‹:
-- ãƒ™ã‚¯ãƒˆãƒ«é¡ä¼¼åº¦: 80%
-- ã‚¿ã‚°é¡ä¼¼åº¦: 60%
-- â†’ ç·åˆã‚¹ã‚³ã‚¢: 80% * 0.7 + 60% * 0.3 = 74%
```

## âœ… æ¤œè¨¼çµæœ

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: "Urban Street Style"

**ã‚¿ã‚°**: street, urban, modern

**æ¤œç´¢çµæœ**:
```
Hybrid Search:
1. Minimal Design (0.0%)
2. Bold Statement (0.0%)
3. Vintage Collection (-2.1%)  # ç•°ãªã‚‹ã‚¹ã‚¿ã‚¤ãƒ« = ä½ã‚¹ã‚³ã‚¢
4. single model person only #1 (-2.6%)
```

â†’ ã‚¿ã‚°ã®é¡ä¼¼æ€§ã«åŸºã¥ã„ã¦æ­£ã—ããƒ©ãƒ³ã‚­ãƒ³ã‚°

## ğŸ‰ ã¾ã¨ã‚

### é”æˆã—ãŸã“ã¨
âœ… æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ï¼ˆç”»åƒãªã—ï¼‰ã§ã‚‚é¡ä¼¼æ¤œç´¢ãŒå¯èƒ½
âœ… ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ç–‘ä¼¼ãƒ™ã‚¯ãƒˆãƒ«ã§8ä»¶ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–
âœ… Pure Vector / Hybrid æ¤œç´¢ã®ä¸¡æ–¹ãŒå‹•ä½œ
âœ… æ–°è¦ç”»åƒç”Ÿæˆæ™‚ã¯CLIPåŸ‹ã‚è¾¼ã¿ã‚’è‡ªå‹•ç”Ÿæˆ

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
ğŸ“ Sentence Transformersã§ã•ã‚‰ã«ç²¾åº¦å‘ä¸Š
ğŸ¨ ç”»åƒãŒæƒã£ãŸã‚‰CLIPåŸ‹ã‚è¾¼ã¿ã«ç½®ãæ›ãˆ
ğŸ“Š A/Bãƒ†ã‚¹ãƒˆã§æœ€é©ãªé‡ã¿ä»˜ã‘ã‚’æ±ºå®š

ã“ã‚Œã§æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨æ–°è¦ãƒ‡ãƒ¼ã‚¿ã®ä¸¡æ–¹ã§é«˜ç²¾åº¦ãªé¡ä¼¼ç”»åƒæ¤œç´¢ãŒå®Ÿç¾ã—ã¾ã—ãŸï¼ğŸš€
